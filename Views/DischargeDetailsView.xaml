<Window x:Class="PDSCalculatorDesktop.Views.DischargeDetailsView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Детальная информация о выпуске" 
        Height="700" 
        Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{DynamicResource MaterialDesignFont}">

    <materialDesign:Card Margin="20" 
                        Padding="25"
                        UniformCornerRadius="15"
                        materialDesign:ElevationAssist.Elevation="Dp8">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Заголовок -->
            <StackPanel Grid.Row="0" Margin="0,0,0,20">
                <TextBlock Text="{Binding DischargeName}"
                          Style="{StaticResource MaterialDesignHeadline5TextBlock}"
                          Foreground="#1976D2"/>
                <TextBlock Margin="0,5,0,0">
                    <Run Text="Код:"/>
                    <Run Text="{Binding DischargeCode}" FontWeight="Medium"/>
                    <Run Text=" | Предприятие:"/>
                    <Run Text="{Binding EnterpriseName}" FontWeight="Medium"/>
                </TextBlock>
            </StackPanel>

            <!-- Вкладки -->
            <TabControl Grid.Row="1" 
                       Grid.RowSpan="2"
                       Style="{StaticResource MaterialDesignTabControl}">

                <!-- Технические параметры -->
                <TabItem Header="Технические параметры">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <Button Grid.Row="0"
                               Command="{Binding AddTechnicalParametersCommand}"
                               Style="{StaticResource MaterialDesignRaisedButton}"
                               Width="200" Height="40" Margin="10"
                               HorizontalAlignment="Right"
                               Background="#1976D2" BorderBrush="#1976D2"
                               materialDesign:ButtonAssist.CornerRadius="10">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="Plus" Width="20" Height="20"/>
                                <TextBlock Text="Добавить параметры" Margin="8,0,0,0"/>
                            </StackPanel>
                        </Button>

                        <materialDesign:Card Grid.Row="1" Margin="10" UniformCornerRadius="10">
                            <DataGrid ItemsSource="{Binding TechnicalParameters}"
                                     AutoGenerateColumns="False"
                                     IsReadOnly="True"
                                     CanUserAddRows="False"
                                     FontSize="12">

                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Дата начала действия" 
                                                       Binding="{Binding ValidFrom, StringFormat='dd.MM.yyyy'}" 
                                                       Width="150"/>
                                    <DataGridTextColumn Header="Диаметр (м)" 
                                                       Binding="{Binding Diameter, StringFormat=N3}" 
                                                       Width="100"/>
                                    <DataGridTextColumn Header="Расход (м³/с)" 
                                                       Binding="{Binding FlowRate, StringFormat=N4}" 
                                                       Width="110"/>
                                    <DataGridTextColumn Header="Скорость теч. (м/с)" 
                                                       Binding="{Binding WaterFlowVelocity, StringFormat=N3}" 
                                                       Width="130"/>
                                    <DataGridTextColumn Header="Угол (°)" 
                                                       Binding="{Binding DischargeAngle, StringFormat=N1}" 
                                                       Width="80"/>
                                    <DataGridTextColumn Header="До поверх. (м)" 
                                                       Binding="{Binding DistanceToWaterSurface, StringFormat=N2}" 
                                                       Width="120"/>
                                    <DataGridTextColumn Header="До берега (м)" 
                                                       Binding="{Binding DistanceToShore, StringFormat=N2}" 
                                                       Width="120"/>
                                    <DataGridTextColumn Header="До ств. (м)" 
                                                       Binding="{Binding DistanceToControlPoint, StringFormat=N2}" 
                                                       Width="110"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </materialDesign:Card>
                    </Grid>
                </TabItem>

                <!-- Концентрации веществ -->
                <TabItem Header="Концентрации загрязняющих веществ">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <Button Grid.Row="0"
                               Command="{Binding AddDischargeConcentrationCommand}"
                               Style="{StaticResource MaterialDesignRaisedButton}"
                               Width="200" Height="40" Margin="10"
                               HorizontalAlignment="Right"
                               Background="#F57C00" BorderBrush="#F57C00"
                               materialDesign:ButtonAssist.CornerRadius="10">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="Plus" Width="20" Height="20"/>
                                <TextBlock Text="Добавить концентрацию" Margin="8,0,0,0"/>
                            </StackPanel>
                        </Button>

                        <materialDesign:Card Grid.Row="1" Margin="10" UniformCornerRadius="10">
                            <DataGrid ItemsSource="{Binding DischargeConcentrations}"
                                 AutoGenerateColumns="False"
                                 IsReadOnly="True"
                                 CanUserAddRows="False"
                                 FontSize="12">

                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Код вещества" 
                                                   Binding="{Binding Substance.Code}" 
                                                   Width="120"/>
                                    <DataGridTextColumn Header="Название вещества" 
                                                   Binding="{Binding Substance.Name}" 
                                                   Width="250"/>
                                    <DataGridTextColumn Header="Концентрация (мг/дм³)" 
                                                   Binding="{Binding Concentration, StringFormat=N4}" 
                                                   Width="180"/>
                                    <DataGridTextColumn Header="Дата измерения" 
                                                   Binding="{Binding MeasurementDate, StringFormat='dd.MM.yyyy HH:mm'}" 
                                                   Width="150"/>
                                    <DataGridTextColumn Header="КНК" 
                                                   Binding="{Binding Substance.KNK, StringFormat=N3}" 
                                                   Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </materialDesign:Card>
                    </Grid>
                </TabItem>

                <!-- Фоновые концентрации -->
                <TabItem Header="Фоновые концентрации (контрольный створ)">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <Button Grid.Row="0"
                               Command="{Binding AddBackgroundConcentrationCommand}"
                               Style="{StaticResource MaterialDesignRaisedButton}"
                               Width="230" Height="40" Margin="10"
                               HorizontalAlignment="Right"
                               Background="#00897B" BorderBrush="#00897B"
                               materialDesign:ButtonAssist.CornerRadius="10">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="Plus" Width="20" Height="20"/>
                                <TextBlock Text="Добавить фон. концентрацию" Margin="8,0,0,0"/>
                            </StackPanel>
                        </Button>

                        <materialDesign:Card Grid.Row="1" Margin="10" UniformCornerRadius="10">
                            <DataGrid ItemsSource="{Binding BackgroundConcentrations}"
                                 AutoGenerateColumns="False"
                                 IsReadOnly="True"
                                 CanUserAddRows="False"
                                 FontSize="12">

                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Код вещества" 
                                                   Binding="{Binding Substance.Code}" 
                                                   Width="120"/>
                                    <DataGridTextColumn Header="Название вещества" 
                                                   Binding="{Binding Substance.Name}" 
                                                   Width="250"/>
                                    <DataGridTextColumn Header="Фоновая концентрация (мг/дм³)" 
                                                   Binding="{Binding Concentration, StringFormat=N4}" 
                                                   Width="220"/>
                                    <DataGridTextColumn Header="Дата измерения" 
                                                   Binding="{Binding MeasurementDate, StringFormat='dd.MM.yyyy HH:mm'}" 
                                                   Width="150"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </materialDesign:Card>
                    </Grid>
                </TabItem>

            </TabControl>
        </Grid>
    </materialDesign:Card>
</Window>